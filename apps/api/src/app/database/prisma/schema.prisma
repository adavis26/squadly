generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DB_URL")
}

model users {
  id        Int            @id @default(autoincrement())
  username  String         @unique
  email     String         @unique
  firstName String
  lastName  String
  password  String
  Chats     chat_members[]
  Messages  messages[]
}

model messages {
  id        Int      @id @default(autoincrement())
  content   String
  chatId    Int
  userId    Int
  read      Int[]
  likes     Int[]
  timestamp DateTime @default(now())
  user      users    @relation(fields: [userId], references: [id], onDelete: Cascade)
  chat      chats    @relation(fields: [chatId], references: [id], onDelete: Cascade)
}

model chats {
  id       Int            @id @default(autoincrement())
  name     String
  members  chat_members[]
  messages messages[]
}

model chat_members {
  chatId Int
  userId Int
  chat   chats @relation(fields: [chatId], references: [id], onDelete: Cascade)
  user   users @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([chatId, userId])
}
